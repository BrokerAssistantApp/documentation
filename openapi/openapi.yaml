openapi: 3.1.0
info:
  title: BrokerAssistant API
  version: 1.0.0
  description: |
    BrokerAssistant API –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ª–æ—Ç–∞–º–∏ –Ω–∞ —Ç–æ—Ä–≥–∞—Ö –ø–æ –±–∞–Ω–∫—Ä–æ—Ç—Å—Ç–≤—É, 
    –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è –º–µ–∂–¥—É –±—Ä–æ–∫–µ—Ä–∞–º–∏ –∏ –∏–Ω–≤–µ—Å—Ç–æ—Ä–∞–º–∏, –∞ —Ç–∞–∫–∂–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –ø—Ä–∏–±—ã–ª–∏. 
    
    üîê –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –∏ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è:
    - –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ —á–µ—Ä–µ–∑ JWT-—Ç–æ–∫–µ–Ω—ã, –ø–µ—Ä–µ–¥–∞–≤–∞–µ–º—ã–µ –≤ `HttpOnly`-cookie.
    - –î–ª—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –≤—ã–ø–æ–ª–Ω–∏—Ç—å –ª–æ–≥–∏–Ω (`/auth/login`), –ø–æ—Å–ª–µ —á–µ–≥–æ —Ç–æ–∫–µ–Ω –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è –≤ –∑–∞–ø—Ä–æ—Å–∞—Ö.
    - –§—Ä–æ–Ω—Ç–µ–Ω–¥ –¥–æ–ª–∂–µ–Ω –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å –∑–∞–ø—Ä–æ—Å—ã —Å `withCredentials: true`, —á—Ç–æ–±—ã –±—Ä–∞—É–∑–µ—Ä –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–µ—Ä–µ–¥–∞–≤–∞–ª `accessToken`.
    - –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ `accessToken` –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è —á–µ—Ä–µ–∑ `refreshToken` (`/auth/refresh`).
    - –î–ª—è –≤—ã—Ö–æ–¥–∞ –∏–∑ —Å–∏—Å—Ç–µ–º—ã –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è `/auth/logout`, —É–¥–∞–ª—è—é—â–∏–π —Å–µ—Å—Å–∏–æ–Ω–Ω—ã–µ —Ç–æ–∫–µ–Ω—ã.
    
    üìÑ –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è API:
    - –ü–æ–ª–Ω—ã–π —Å–ø–∏—Å–æ–∫ —ç–Ω–¥–ø–æ–∏–Ω—Ç–æ–≤ –¥–æ—Å—Ç—É–ø–µ–Ω –≤ —Ä–∞–∑–¥–µ–ª–µ "Paths".
    - –û–ø–∏—Å–∞–Ω–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –∑–∞–ø—Ä–æ—Å–æ–≤ –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤ "Schemas".
servers:
  - url: "https://api.brokerassistant.com"
    description: "Production server"
  - url: "http://localhost:8080"
    description: "Development server"
tags:
  - name: "Auth"
    description: "–ú–µ—Ç–æ–¥—ã –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏"
  - name: "Users"
    description: "–ú–µ—Ç–æ–¥—ã —Ä–∞–±–æ—Ç—ã —Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏"
  - name: "Members"
    description: "–ú–µ—Ç–æ–¥—ã —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —É—á–∞—Å—Ç–Ω–∏–∫–∞–º–∏"
  - name: "Lots"
    description: "–ú–µ—Ç–æ–¥—ã —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ª–æ—Ç–∞–º–∏"
  - name: "LotMembers"
    description: "–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —É—á–∞—Å—Ç–Ω–∏–∫–∞–º–∏ –ª–æ—Ç–æ–≤"
  - name: "LotStatus"
    description: "–ú–µ—Ç–æ–¥—ã —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Å—Ç–∞—Ç—É—Å–∞–º–∏ –ª–æ—Ç–æ–≤"
  - name: "Expenses"
    description: "–£—á–µ—Ç —Ä–∞—Å—Ö–æ–¥–æ–≤"
  - name: "Transactions"
    description: "–§–∏–Ω–∞–Ω—Å–æ–≤—ã–µ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏"
  - name: "Financials"
    description: "–§–∏–Ω–∞–Ω—Å–æ–≤—ã–π —É—á–µ—Ç –ø–æ –ª–æ—Ç–∞–º"
#  - name: "Analytics"
#    description: "–ê–Ω–∞–ª–∏—Ç–∏—á–µ—Å–∫–∏–µ –¥–∞–Ω–Ω—ã–µ"
security:
  - SessionCookiesJWT: [ ]

paths:
  /auth/register:
    $ref: './paths/auth/register.yaml'

  /auth/login:
    $ref: './paths/auth/login.yaml'

  /auth/status:
    $ref: './paths/auth/status.yaml'

  /auth/refresh:
    $ref: './paths/auth/refresh.yaml'

  /auth/logout:
    $ref: './paths/auth/logout.yaml'

#  /auth/yandex/login:
#    get:
#      summary: "–ü–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª—è–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –Ω–∞ –Ø–Ω–¥–µ–∫—Å"
#      tags:
#        - "Auth"

#  /auth/yandex/callback:
#    get:
#      summary: "–û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç code, –ø–æ–ª—É—á–∞–µ—Ç accessToken –æ—Ç –Ø–Ω–¥–µ–∫—Å–∞"
#      tags:
#        - "Auth"

#  /auth/yandex/register:
#    post:
#      summary: "–°–æ–∑–¥–∞—ë—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è —Å auth_method = 'yandex'"
#      tags:
#        - "Auth"

#  /auth/yandex/connect:
#    post:
#      summary: "–ü—Ä–∏–≤—è–∑—ã–≤–∞–µ—Ç –Ø–Ω–¥–µ–∫—Å ID –∫ —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–º—É –∞–∫–∫–∞—É–Ω—Ç—É"
#      tags:
#        - "Auth"

#  /auth/yandex/unlink:
#    post:
#      summary: "–û—Ç–≤—è–∑—ã–≤–∞–µ—Ç –Ø–Ω–¥–µ–∫—Å ID"
#      tags:
#        - "Auth"

  /users/me:
    $ref: './paths/users/users.me.yaml'

  /members:
    $ref: './paths/members/members.yaml'

  /members/{userId}:
    $ref: './paths/members/members.userId.yaml'

  /lots:
    $ref: './paths/lots/lots.yaml'

  /lots/{lotId}:
    $ref: './paths/lots/lots.lotId.yaml'

  /lots/{lotId}/members:
    $ref: './paths/lotMembers/members.yaml'

  /lots/{lotId}/members/{memberId}:
    $ref: './paths/lotMembers/members.memberId.yaml'

  /lots/{lotId}/status:
    $ref: './paths/lotStatus/status.yaml'

  /lots/{lotId}/status-history:
    $ref: './paths/lotStatus/status-history.yaml'

  /lots/{lotId}/expenses:
    $ref: './paths/expenses/expenses.yaml'

  /lots/{lotId}/expenses/{transactionId}:
    $ref: './paths/expenses/expenses.transactionId.yaml'

  /lots/{lotId}/transactions:
    $ref: './paths/transactions/transactions.yaml'

  /lots/{lotId}/financials:
    $ref: './paths/financials/financials.yaml'

#  /analytics/dashboard:
#    get:
#      summary: "–ü–æ–ª—É—á–∏—Ç—å –æ–±—â—É—é —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É"
#      tags:
#        - "Analytics"
#      responses:
#        "200":
#          description: "–î–∞–Ω–Ω—ã–µ –∞–Ω–∞–ª–∏—Ç–∏–∫–∏"
components:
  schemas:
    BaseResponse:
      $ref: './components/schemas/BaseResponse.yaml#/BaseResponse'
    BadErrorResponse:
      $ref: './components/schemas/BadErrorResponse.yaml#/BadErrorResponse'
    ValidationErrorResponse:
      $ref: './components/schemas/BadErrorResponse.yaml#/ValidationErrorResponse'
    UnauthorizedErrorResponse:
      $ref: './components/schemas/UnauthorizedErrorResponse.yaml#/UnauthorizedErrorResponse'
    ForbiddenErrorResponse:
      $ref: './components/schemas/ForbiddenErrorResponse.yaml#/ForbiddenErrorResponse'
    NotFoundErrorResponse:
      $ref: './components/schemas/NotFoundErrorResponse.yaml#/NotFoundErrorResponse'
    Error:
      $ref: './components/schemas/Error.yaml#/Error'
    Meta:
      $ref: './components/schemas/Meta.yaml#/Meta'
    User:
      $ref: './components/schemas/User.yaml#/User'
    User.WithIsBroker:
      $ref: './components/schemas/User.yaml#/User.WithIsBroker'
    User.WithoutIsBroker:
      $ref: './components/schemas/User.yaml#/User.WithoutIsBroker'
    Lot:
      $ref: './components/schemas/Lot.yaml#/Lot'
    Lot.WithoutStatus:
      $ref: './components/schemas/Lot.yaml#/Lot.WithoutStatus'
    Lot.WithStatus:
      $ref: './components/schemas/Lot.yaml#/Lot.WithStatus'
    LotMember:
      $ref: './components/schemas/LotMember.yaml#/LotMember'
    LotStatusHistory:
      $ref: './components/schemas/LotStatusHistory.yaml#/LotStatusHistory'
    LotExpense:
      $ref: './components/schemas/LotExpense.yaml#/LotExpense'
    LotTransaction:
      $ref: './components/schemas/LotTransaction.yaml#/LotTransaction'
    LotTransactionGroup:
      $ref: './components/schemas/LotTransaction.yaml#/LotTransactionGroup'
    LotFinancials:
      $ref: './components/schemas/LotFinancials.yaml#/LotFinancials'
  securitySchemes:
    $ref: './components/securitySchemes.yaml'